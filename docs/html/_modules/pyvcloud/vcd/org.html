
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pyvcloud.vcd.org &#8212; Pyvcloud  documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pyvcloud.vcd.org</h1><div class="highlight"><pre>
<span></span><span class="c1"># VMware vCloud Director Python SDK</span>
<span class="c1"># Copyright (c) 2014-2018 VMware, Inc. All Rights Reserved.</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">tarfile</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">traceback</span>

<span class="kn">from</span> <span class="nn">lxml</span> <span class="k">import</span> <span class="n">etree</span>
<span class="kn">from</span> <span class="nn">lxml</span> <span class="k">import</span> <span class="n">objectify</span>

<span class="kn">from</span> <span class="nn">pyvcloud.vcd.acl</span> <span class="k">import</span> <span class="n">Acl</span>
<span class="kn">from</span> <span class="nn">pyvcloud.vcd.client</span> <span class="k">import</span> <span class="n">_TaskMonitor</span>
<span class="kn">from</span> <span class="nn">pyvcloud.vcd.client</span> <span class="k">import</span> <span class="n">E</span>
<span class="kn">from</span> <span class="nn">pyvcloud.vcd.client</span> <span class="k">import</span> <span class="n">E_OVF</span>
<span class="kn">from</span> <span class="nn">pyvcloud.vcd.client</span> <span class="k">import</span> <span class="n">EntityType</span>
<span class="kn">from</span> <span class="nn">pyvcloud.vcd.client</span> <span class="k">import</span> <span class="n">find_link</span>
<span class="kn">from</span> <span class="nn">pyvcloud.vcd.client</span> <span class="k">import</span> <span class="n">get_links</span>
<span class="kn">from</span> <span class="nn">pyvcloud.vcd.client</span> <span class="k">import</span> <span class="n">NSMAP</span>
<span class="kn">from</span> <span class="nn">pyvcloud.vcd.client</span> <span class="k">import</span> <span class="n">QueryResultFormat</span>
<span class="kn">from</span> <span class="nn">pyvcloud.vcd.client</span> <span class="k">import</span> <span class="n">RelationType</span>
<span class="kn">from</span> <span class="nn">pyvcloud.vcd.system</span> <span class="k">import</span> <span class="n">System</span>
<span class="kn">from</span> <span class="nn">pyvcloud.vcd.utils</span> <span class="k">import</span> <span class="n">to_dict</span>

<span class="n">DEFAULT_CHUNK_SIZE</span> <span class="o">=</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>


<div class="viewcode-block" id="Org"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org">[docs]</a><span class="k">class</span> <span class="nc">Org</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resource</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor for Org objects.</span>

<span class="sd">        :param client: (pyvcloud.vcd.client): The client.</span>
<span class="sd">        :param href: (str): URI of the entity.</span>
<span class="sd">        :param resource: (lxml.objectify.ObjectifiedElement): XML</span>
<span class="sd">            representation of the entity.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">client</span>
        <span class="k">if</span> <span class="n">href</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">resource</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Org initialization failed as arguments&quot;</span>
                            <span class="s2">&quot; are either invalid or None&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">href</span> <span class="o">=</span> <span class="n">href</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">resource</span>
        <span class="k">if</span> <span class="n">resource</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">href</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">href_admin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/api/org/&#39;</span><span class="p">,</span> <span class="s1">&#39;/api/admin/org/&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Org.reload"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.reload">[docs]</a>    <span class="k">def</span> <span class="nf">reload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>

<div class="viewcode-block" id="Org.get_name"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.get_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Org.create_catalog"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.create_catalog">[docs]</a>    <span class="k">def</span> <span class="nf">create_catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">AdminCatalog</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">Description</span><span class="p">(</span><span class="n">description</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post_linked_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resource</span><span class="p">,</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span> <span class="n">EntityType</span><span class="o">.</span><span class="n">ADMIN_CATALOG</span><span class="o">.</span><span class="n">value</span><span class="p">,</span></div>
            <span class="n">catalog</span><span class="p">)</span>

<div class="viewcode-block" id="Org.create_role"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.create_role">[docs]</a>    <span class="k">def</span> <span class="nf">create_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role_name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">rights</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a role in the organization.</span>

<span class="sd">        :param role_name: (str): name of the role to be created</span>
<span class="sd">        :param description: (str): description of the role</span>
<span class="sd">        :param rights: (tuple of (str)) names of zero or more rights to be</span>
<span class="sd">            associated with the role</span>
<span class="sd">        :return: RoleType just created</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">org_admin_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href_admin</span><span class="p">)</span>
        <span class="n">role</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">Role</span><span class="p">(</span>
            <span class="n">E</span><span class="o">.</span><span class="n">Description</span><span class="p">(</span><span class="n">description</span><span class="p">),</span> <span class="n">E</span><span class="o">.</span><span class="n">RightReferences</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">role_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rights</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">for</span> <span class="n">right</span> <span class="ow">in</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">rights</span><span class="p">):</span>
            <span class="n">right_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_right_record</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
            <span class="n">role</span><span class="o">.</span><span class="n">RightReferences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">E</span><span class="o">.</span><span class="n">RightReference</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">right_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span>
                    <span class="n">href</span><span class="o">=</span><span class="n">right_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">),</span>
                    <span class="nb">type</span><span class="o">=</span><span class="n">EntityType</span><span class="o">.</span><span class="n">RIGHT</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post_linked_resource</span><span class="p">(</span></div>
            <span class="n">org_admin_resource</span><span class="p">,</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span> <span class="n">EntityType</span><span class="o">.</span><span class="n">ROLE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">role</span><span class="p">)</span>

<div class="viewcode-block" id="Org.delete_role"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.delete_role">[docs]</a>    <span class="k">def</span> <span class="nf">delete_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes specified role from the organization.</span>

<span class="sd">        :param name: (str): name of the role</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>
        <span class="n">role_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_role_record</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">delete_resource</span><span class="p">(</span><span class="n">role_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>

<div class="viewcode-block" id="Org.delete_catalog"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.delete_catalog">[docs]</a>    <span class="k">def</span> <span class="nf">delete_catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">org</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>
        <span class="n">links</span> <span class="o">=</span> <span class="n">get_links</span><span class="p">(</span>
            <span class="n">org</span><span class="p">,</span> <span class="n">rel</span><span class="o">=</span><span class="n">RelationType</span><span class="o">.</span><span class="n">DOWN</span><span class="p">,</span> <span class="n">media_type</span><span class="o">=</span><span class="n">EntityType</span><span class="o">.</span><span class="n">CATALOG</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">link</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">admin_href</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">href</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/api/catalog/&#39;</span><span class="p">,</span>
                                               <span class="s1">&#39;/api/admin/catalog/&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">delete_resource</span><span class="p">(</span><span class="n">admin_href</span><span class="p">)</span></div>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Catalog not found.&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Org.list_catalogs"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.list_catalogs">[docs]</a>    <span class="k">def</span> <span class="nf">list_catalogs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">is_sysadmin</span><span class="p">():</span>
            <span class="n">resource_type</span> <span class="o">=</span> <span class="s1">&#39;adminCatalog&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">resource_type</span> <span class="o">=</span> <span class="s1">&#39;catalog&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_typed_query</span><span class="p">(</span>
            <span class="n">resource_type</span><span class="p">,</span> <span class="n">query_result_format</span><span class="o">=</span><span class="n">QueryResultFormat</span><span class="o">.</span><span class="n">ID_RECORDS</span><span class="p">)</span>
        <span class="n">records</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">execute</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">to_dict</span><span class="p">(</span>
                        <span class="n">r</span><span class="p">,</span>
                        <span class="n">resource_type</span><span class="o">=</span><span class="n">resource_type</span><span class="p">,</span>
                        <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">,</span> <span class="s1">&#39;org&#39;</span><span class="p">]))</span></div>
        <span class="k">return</span> <span class="n">result</span>

<div class="viewcode-block" id="Org.get_catalog"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.get_catalog">[docs]</a>    <span class="k">def</span> <span class="nf">get_catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span></div>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog_resource</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="Org.get_catalog_resource"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.get_catalog_resource">[docs]</a>    <span class="k">def</span> <span class="nf">get_catalog_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">is_admin_operation</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">org</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>
        <span class="n">links</span> <span class="o">=</span> <span class="n">get_links</span><span class="p">(</span>
            <span class="n">org</span><span class="p">,</span> <span class="n">rel</span><span class="o">=</span><span class="n">RelationType</span><span class="o">.</span><span class="n">DOWN</span><span class="p">,</span> <span class="n">media_type</span><span class="o">=</span><span class="n">EntityType</span><span class="o">.</span><span class="n">CATALOG</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">link</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">href</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">href</span>
                <span class="k">if</span> <span class="n">is_admin_operation</span><span class="p">:</span>
                    <span class="n">href</span> <span class="o">=</span> <span class="n">href</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/api/catalog/&#39;</span><span class="p">,</span> <span class="s1">&#39;/api/admin/catalog/&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="n">href</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Catalog not found (or)&#39;</span></div>
                        <span class="s1">&#39; Access to resource is forbidden&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Org.update_catalog"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.update_catalog">[docs]</a>    <span class="k">def</span> <span class="nf">update_catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_catalog_name</span><span class="p">,</span> <span class="n">new_catalog_name</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update the name and/or description of a catalog.</span>

<span class="sd">        :param old_catalog_name: (str): The current name of the catalog.</span>
<span class="sd">        :param new_catalog_name: (str): The new name of the catalog.</span>
<span class="sd">        :param description: (str): The new description of the catalog.</span>
<span class="sd">        :return:  A :class:`lxml.objectify.StringElement` object describing</span>
<span class="sd">            the updated catalog.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>
        <span class="n">org</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span>
        <span class="n">links</span> <span class="o">=</span> <span class="n">get_links</span><span class="p">(</span>
            <span class="n">org</span><span class="p">,</span> <span class="n">rel</span><span class="o">=</span><span class="n">RelationType</span><span class="o">.</span><span class="n">DOWN</span><span class="p">,</span> <span class="n">media_type</span><span class="o">=</span><span class="n">EntityType</span><span class="o">.</span><span class="n">CATALOG</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">old_catalog_name</span> <span class="o">==</span> <span class="n">link</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>
                <span class="n">href</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>
                <span class="n">admin_href</span> <span class="o">=</span> <span class="n">href</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/api/catalog/&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;/api/admin/catalog/&#39;</span><span class="p">)</span>
                <span class="n">admin_view_of_catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="n">admin_href</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">new_catalog_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">admin_view_of_catalog</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">new_catalog_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">admin_view_of_catalog</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">Description</span><span class="p">(</span>
                        <span class="n">description</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">put_resource</span><span class="p">(</span>
                    <span class="n">admin_href</span><span class="p">,</span>
                    <span class="n">admin_view_of_catalog</span><span class="p">,</span>
                    <span class="n">media_type</span><span class="o">=</span><span class="n">EntityType</span><span class="o">.</span><span class="n">ADMIN_CATALOG</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Catalog not found.&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Org.share_catalog"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.share_catalog">[docs]</a>    <span class="k">def</span> <span class="nf">share_catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">share</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">is_published</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span> <span class="k">if</span> <span class="n">share</span> <span class="k">else</span> <span class="s1">&#39;false&#39;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">PublishCatalogParams</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">IsPublished</span><span class="p">(</span><span class="n">is_published</span><span class="p">))</span>
        <span class="n">href</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/action/publish&#39;</span>
        <span class="n">admin_href</span> <span class="o">=</span> <span class="n">href</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/api/catalog/&#39;</span><span class="p">,</span> <span class="s1">&#39;/api/admin/catalog/&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post_resource</span><span class="p">(</span>
            <span class="n">admin_href</span><span class="p">,</span>
            <span class="n">params</span><span class="p">,</span></div>
            <span class="n">media_type</span><span class="o">=</span><span class="n">EntityType</span><span class="o">.</span><span class="n">PUBLISH_CATALOG_PARAMS</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="Org.list_catalog_items"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.list_catalog_items">[docs]</a>    <span class="k">def</span> <span class="nf">list_catalog_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">catalog</span><span class="o">.</span><span class="n">CatalogItems</span><span class="o">.</span><span class="n">getchildren</span><span class="p">():</span>
            <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span> <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)})</span></div>
        <span class="k">return</span> <span class="n">items</span>

<div class="viewcode-block" id="Org.get_catalog_item"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.get_catalog_item">[docs]</a>    <span class="k">def</span> <span class="nf">get_catalog_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">item_name</span><span class="p">):</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">catalog</span><span class="o">.</span><span class="n">CatalogItems</span><span class="o">.</span><span class="n">getchildren</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">item_name</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span></div>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Catalog item not found.&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Org.delete_catalog_item"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.delete_catalog_item">[docs]</a>    <span class="k">def</span> <span class="nf">delete_catalog_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">item_name</span><span class="p">):</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">catalog</span><span class="o">.</span><span class="n">CatalogItems</span><span class="o">.</span><span class="n">getchildren</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">item_name</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">delete_resource</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span></div>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Item not found.&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Org.upload_media"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.upload_media">[docs]</a>    <span class="k">def</span> <span class="nf">upload_media</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">catalog_name</span><span class="p">,</span>
                     <span class="n">file_name</span><span class="p">,</span>
                     <span class="n">item_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                     <span class="n">chunk_size</span><span class="o">=</span><span class="n">DEFAULT_CHUNK_SIZE</span><span class="p">,</span>
                     <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">stat_info</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">item_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">item_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="n">image_type</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">item_name</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">media</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">Media</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">item_name</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">stat_info</span><span class="o">.</span><span class="n">st_size</span><span class="p">),</span> <span class="n">imageType</span><span class="o">=</span><span class="n">image_type</span><span class="p">)</span>
        <span class="n">media</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">Description</span><span class="p">(</span><span class="n">description</span><span class="p">))</span>
        <span class="n">catalog_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post_resource</span><span class="p">(</span>
            <span class="n">catalog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/action/upload&#39;</span><span class="p">,</span> <span class="n">media</span><span class="p">,</span>
            <span class="n">EntityType</span><span class="o">.</span><span class="n">MEDIA</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">entity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="n">catalog_item</span><span class="o">.</span><span class="n">Entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>
        <span class="n">file_href</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">Files</span><span class="o">.</span><span class="n">File</span><span class="o">.</span><span class="n">Link</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span></div>
            <span class="n">file_name</span><span class="p">,</span> <span class="n">file_href</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>

<div class="viewcode-block" id="Org.download_catalog_item"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.download_catalog_item">[docs]</a>    <span class="k">def</span> <span class="nf">download_catalog_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                              <span class="n">catalog_name</span><span class="p">,</span>
                              <span class="n">item_name</span><span class="p">,</span>
                              <span class="n">file_name</span><span class="p">,</span>
                              <span class="n">chunk_size</span><span class="o">=</span><span class="n">DEFAULT_CHUNK_SIZE</span><span class="p">,</span>
                              <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">task_callback</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog_item</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">,</span> <span class="n">item_name</span><span class="p">)</span>
        <span class="n">item_type</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">Entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
        <span class="n">enable_href</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">Entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/action/enableDownload&#39;</span>
        <span class="n">task</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post_resource</span><span class="p">(</span><span class="n">enable_href</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">tm</span> <span class="o">=</span> <span class="n">_TaskMonitor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">)</span>
        <span class="n">tm</span><span class="o">.</span><span class="n">wait_for_success</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">task_callback</span><span class="p">)</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">Entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>
        <span class="n">bytes_written</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">item_type</span> <span class="o">==</span> <span class="n">EntityType</span><span class="o">.</span><span class="n">MEDIA</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">Files</span><span class="o">.</span><span class="n">File</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">)</span>
            <span class="n">download_href</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">Files</span><span class="o">.</span><span class="n">File</span><span class="o">.</span><span class="n">Link</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>
            <span class="n">bytes_written</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">download_from_uri</span><span class="p">(</span>
                <span class="n">download_href</span><span class="p">,</span>
                <span class="n">file_name</span><span class="p">,</span>
                <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span>
                <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="n">EntityType</span><span class="o">.</span><span class="n">VAPP_TEMPLATE</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">ovf_descriptor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_linked_resource</span><span class="p">(</span>
                <span class="n">item</span><span class="p">,</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">DOWNLOAD_DEFAULT</span><span class="p">,</span> <span class="n">EntityType</span><span class="o">.</span><span class="n">TEXT_XML</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">transfer_uri</span> <span class="o">=</span> <span class="n">find_link</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">DOWNLOAD_DEFAULT</span><span class="p">,</span>
                                     <span class="n">EntityType</span><span class="o">.</span><span class="n">TEXT_XML</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">href</span>
            <span class="n">transfer_uri</span> <span class="o">=</span> <span class="n">transfer_uri</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/descriptor.ovf&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
            <span class="n">tempdir</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tempdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
                <span class="n">ovf_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempdir</span><span class="p">,</span> <span class="s1">&#39;descriptor.ovf&#39;</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ovf_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">payload</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span>
                        <span class="n">ovf_descriptor</span><span class="p">,</span>
                        <span class="n">pretty_print</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">xml_declaration</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

                <span class="n">ns</span> <span class="o">=</span> <span class="s1">&#39;{&#39;</span> <span class="o">+</span> <span class="n">NSMAP</span><span class="p">[</span><span class="s1">&#39;ovf&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span>
                <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">ovf_descriptor</span><span class="o">.</span><span class="n">References</span><span class="o">.</span><span class="n">File</span><span class="p">:</span>
                    <span class="n">source_file</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;href&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ns</span> <span class="o">+</span> <span class="s1">&#39;href&#39;</span><span class="p">),</span>
                        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ns</span> <span class="o">+</span> <span class="s1">&#39;id&#39;</span><span class="p">),</span>
                        <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ns</span> <span class="o">+</span> <span class="s1">&#39;size&#39;</span><span class="p">)</span>
                    <span class="p">}</span>
                    <span class="n">target_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempdir</span><span class="p">,</span> <span class="n">source_file</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">])</span>
                    <span class="n">uri</span> <span class="o">=</span> <span class="n">transfer_uri</span> <span class="o">+</span> <span class="n">source_file</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">]</span>
                    <span class="n">num_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">download_from_uri</span><span class="p">(</span>
                        <span class="n">uri</span><span class="p">,</span>
                        <span class="n">target_file</span><span class="p">,</span>
                        <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span>
                        <span class="n">size</span><span class="o">=</span><span class="n">source_file</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">],</span>
                        <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">num_bytes</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="n">source_file</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]):</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;download incomplete for file </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
                                        <span class="n">source_file</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">])</span>
                    <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source_file</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">tempdir</span><span class="p">)</span>
                    <span class="n">tar</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;descriptor.ovf&#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                        <span class="n">tar</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">])</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">tempdir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
                    <span class="n">stat_info</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
                    <span class="n">bytes_written</span> <span class="o">=</span> <span class="n">stat_info</span><span class="o">.</span><span class="n">st_size</span></div>
        <span class="k">return</span> <span class="n">bytes_written</span>

<div class="viewcode-block" id="Org.upload_file"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.upload_file">[docs]</a>    <span class="k">def</span> <span class="nf">upload_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">file_name</span><span class="p">,</span>
                    <span class="n">href</span><span class="p">,</span>
                    <span class="n">chunk_size</span><span class="o">=</span><span class="n">DEFAULT_CHUNK_SIZE</span><span class="p">,</span>
                    <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">transferred</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">stat_info</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">while</span> <span class="n">transferred</span> <span class="o">&lt;</span> <span class="n">stat_info</span><span class="o">.</span><span class="n">st_size</span><span class="p">:</span>
                <span class="n">my_bytes</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">chunk_size</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">my_bytes</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">chunk_size</span><span class="p">:</span>
                    <span class="n">range_str</span> <span class="o">=</span> <span class="s1">&#39;bytes </span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> \
                                <span class="p">(</span><span class="n">transferred</span><span class="p">,</span>
                                 <span class="nb">len</span><span class="p">(</span><span class="n">my_bytes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="n">stat_info</span><span class="o">.</span><span class="n">st_size</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">upload_fragment</span><span class="p">(</span><span class="n">href</span><span class="p">,</span> <span class="n">my_bytes</span><span class="p">,</span> <span class="n">range_str</span><span class="p">)</span>
                    <span class="n">transferred</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">my_bytes</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">callback</span><span class="p">(</span><span class="n">transferred</span><span class="p">,</span> <span class="n">stat_info</span><span class="o">.</span><span class="n">st_size</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="n">transferred</span>

<div class="viewcode-block" id="Org.upload_ovf"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.upload_ovf">[docs]</a>    <span class="k">def</span> <span class="nf">upload_ovf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                   <span class="n">catalog_name</span><span class="p">,</span>
                   <span class="n">file_name</span><span class="p">,</span>
                   <span class="n">item_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                   <span class="n">chunk_size</span><span class="o">=</span><span class="n">DEFAULT_CHUNK_SIZE</span><span class="p">,</span>
                   <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog</span><span class="p">(</span><span class="n">catalog_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">item_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">item_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="n">tempdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">total_bytes</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ova</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
            <span class="n">ova</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">tempdir</span><span class="p">)</span>
            <span class="n">ova</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">ovf_file</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">tempdir</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="n">fn</span><span class="p">,</span> <span class="n">ex</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ex</span> <span class="o">==</span> <span class="s1">&#39;.ovf&#39;</span><span class="p">:</span>
                    <span class="n">ovf_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempdir</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">ovf_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">stat_info</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">ovf_file</span><span class="p">)</span>
                <span class="n">total_bytes</span> <span class="o">+=</span> <span class="n">stat_info</span><span class="o">.</span><span class="n">st_size</span>
                <span class="n">ovf</span> <span class="o">=</span> <span class="n">objectify</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">ovf_file</span><span class="p">)</span>
                <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">ns</span> <span class="o">=</span> <span class="s1">&#39;{&#39;</span> <span class="o">+</span> <span class="n">NSMAP</span><span class="p">[</span><span class="s1">&#39;ovf&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">ovf</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span><span class="o">.</span><span class="n">References</span><span class="o">.</span><span class="n">File</span><span class="p">:</span>
                    <span class="n">source_file</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;href&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ns</span> <span class="o">+</span> <span class="s1">&#39;href&#39;</span><span class="p">),</span>
                        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ns</span> <span class="o">+</span> <span class="s1">&#39;id&#39;</span><span class="p">),</span>
                        <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ns</span> <span class="o">+</span> <span class="s1">&#39;size&#39;</span><span class="p">)</span>
                    <span class="p">}</span>
                    <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source_file</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">item_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">item_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
                <span class="n">params</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">UploadVAppTemplateParams</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">item_name</span><span class="p">)</span>
                <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">Description</span><span class="p">(</span><span class="n">description</span><span class="p">))</span>
                <span class="n">catalog_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post_resource</span><span class="p">(</span>
                    <span class="n">catalog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/action/upload&#39;</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span>
                    <span class="n">EntityType</span><span class="o">.</span><span class="n">UPLOAD_VAPP_TEMPLATE_PARAMS</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="n">entity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
                    <span class="n">catalog_item</span><span class="o">.</span><span class="n">Entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>
                <span class="n">file_href</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">Files</span><span class="o">.</span><span class="n">File</span><span class="o">.</span><span class="n">Link</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">put_resource</span><span class="p">(</span><span class="n">file_href</span><span class="p">,</span> <span class="n">ovf</span><span class="p">,</span> <span class="s1">&#39;text/xml&#39;</span><span class="p">)</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
                    <span class="n">entity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
                        <span class="n">catalog_item</span><span class="o">.</span><span class="n">Entity</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entity</span><span class="o">.</span><span class="n">Files</span><span class="o">.</span><span class="n">File</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="k">for</span> <span class="n">source_file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">target_file</span> <span class="ow">in</span> <span class="n">entity</span><span class="o">.</span><span class="n">Files</span><span class="o">.</span><span class="n">File</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">source_file</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">target_file</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">):</span>
                            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tempdir</span><span class="p">,</span>
                                                     <span class="n">source_file</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>
                            <span class="n">total_bytes</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span>
                                <span class="n">file_path</span><span class="p">,</span>
                                <span class="n">target_file</span><span class="o">.</span><span class="n">Link</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">),</span>
                                <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span>
                                <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">tempdir</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">tempdir</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>
        <span class="k">return</span> <span class="n">total_bytes</span>

<div class="viewcode-block" id="Org.get_vdc"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.get_vdc">[docs]</a>    <span class="k">def</span> <span class="nf">get_vdc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>
        <span class="n">links</span> <span class="o">=</span> <span class="n">get_links</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resource</span><span class="p">,</span>
            <span class="n">rel</span><span class="o">=</span><span class="n">RelationType</span><span class="o">.</span><span class="n">DOWN</span><span class="p">,</span>
            <span class="n">media_type</span><span class="o">=</span><span class="n">EntityType</span><span class="o">.</span><span class="n">VDC</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">link</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">href</span><span class="p">)</span></div>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Vdc </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> not found&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="Org.list_vdcs"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.list_vdcs">[docs]</a>    <span class="k">def</span> <span class="nf">list_vdcs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">get_links</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resource</span><span class="p">,</span> <span class="n">media_type</span><span class="o">=</span><span class="n">EntityType</span><span class="o">.</span><span class="n">VDC</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;href&#39;</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">href</span><span class="p">})</span></div>
        <span class="k">return</span> <span class="n">result</span>

<div class="viewcode-block" id="Org.capture_vapp"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.capture_vapp">[docs]</a>    <span class="k">def</span> <span class="nf">capture_vapp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">catalog_resource</span><span class="p">,</span>
                     <span class="n">vapp_href</span><span class="p">,</span>
                     <span class="n">catalog_item_name</span><span class="p">,</span>
                     <span class="n">description</span><span class="p">,</span>
                     <span class="n">customize_on_instantiate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Capture vApp as a catalog item template.</span>

<span class="sd">        :param catalog_resource: (`lxml.objectify.StringElement`): The</span>
<span class="sd">            catalog.</span>
<span class="sd">        :param vapp_href: (str): The href of the vApp to capture.</span>
<span class="sd">        :param catalog_item_name: (str): The name of the target catalog item.</span>
<span class="sd">        :param description: (str): The description of the catalog item.</span>
<span class="sd">        :param customize_on_instantiate: (bool): A flag indicating if the</span>
<span class="sd">            vApp to be instantiated from this vApp template can be customized.</span>
<span class="sd">        :param overwrite: (bool): A flag indicating if the item in the catalog</span>
<span class="sd">            has to be overwritten if it already exists. If it doesn&#39;t exists,</span>
<span class="sd">            this flag is not used.</span>
<span class="sd">        :return:  A :class:`lxml.objectify.StringElement` object describing</span>
<span class="sd">            the updated catalog item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">contents</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">CaptureVAppParams</span><span class="p">(</span>
            <span class="n">E</span><span class="o">.</span><span class="n">Description</span><span class="p">(</span><span class="n">description</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">href</span><span class="o">=</span><span class="n">vapp_href</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="n">catalog_item_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">customize_on_instantiate</span><span class="p">:</span>
            <span class="n">contents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">E</span><span class="o">.</span><span class="n">CustomizationSection</span><span class="p">(</span>
                    <span class="n">E_OVF</span><span class="o">.</span><span class="n">Info</span><span class="p">(</span><span class="s1">&#39;VApp template customization section&#39;</span><span class="p">),</span>
                    <span class="n">E</span><span class="o">.</span><span class="n">CustomizeOnInstantiate</span><span class="p">(</span><span class="s1">&#39;true&#39;</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog_item</span><span class="p">(</span>
                    <span class="n">catalog_resource</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span> <span class="n">catalog_item_name</span><span class="p">)</span>
                <span class="n">contents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">E</span><span class="o">.</span><span class="n">TargetCatalogItem</span><span class="p">(</span>
                        <span class="n">href</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">),</span>
                        <span class="nb">id</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span>
                        <span class="nb">type</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">),</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)))</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post_linked_resource</span><span class="p">(</span>
            <span class="n">catalog_resource</span><span class="p">,</span>
            <span class="n">rel</span><span class="o">=</span><span class="n">RelationType</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span>
            <span class="n">media_type</span><span class="o">=</span><span class="n">EntityType</span><span class="o">.</span><span class="n">CAPTURE_VAPP_PARAMS</span><span class="o">.</span><span class="n">value</span><span class="p">,</span></div>
            <span class="n">contents</span><span class="o">=</span><span class="n">contents</span><span class="p">)</span>

<div class="viewcode-block" id="Org.create_user"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.create_user">[docs]</a>    <span class="k">def</span> <span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">user_name</span><span class="p">,</span>
                    <span class="n">password</span><span class="p">,</span>
                    <span class="n">role_href</span><span class="p">,</span>
                    <span class="n">full_name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="n">email</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="n">telephone</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="n">im</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="n">alert_email</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="n">alert_email_prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                    <span class="n">stored_vm_quota</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">deployed_vm_quota</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">is_group_role</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">is_default_cached</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">is_external</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">is_alert_enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">is_enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create User in the current Org.</span>

<span class="sd">        :param user_name: The username of the user</span>
<span class="sd">        :param password: The password of the user</span>
<span class="sd">        :param role_href: The href of the user role</span>
<span class="sd">        :param full_name: The full name of the user</span>
<span class="sd">        :param description: The description for the User</span>
<span class="sd">        :param email: The email of the user</span>
<span class="sd">        :param telephone: The telephone of the user</span>
<span class="sd">        :param im: The im address of the user</span>
<span class="sd">        :param alert_email: The alert email address</span>
<span class="sd">        :param alert_email_prefix: The string to prepend to the alert message</span>
<span class="sd">                subject line</span>
<span class="sd">        :param stored_vm_quota: The quota of vApps that this user can store</span>
<span class="sd">        :param deployed_vm_quota: The quota of vApps that this user can deploy</span>
<span class="sd">                concurrently</span>
<span class="sd">        :param is_group_role: Indicates if the user has a group role</span>
<span class="sd">        :param is_default_cached: Indicates if user should be cached</span>
<span class="sd">        :param is_external: Indicates if user is imported from an external</span>
<span class="sd">                source</span>
<span class="sd">        :param is_alert_enabled: The alert email address</span>
<span class="sd">        :param is_enabled: Enable user</span>
<span class="sd">        :return: (UserType) Created user object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">resource_admin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href_admin</span><span class="p">)</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">User</span><span class="p">(</span>
            <span class="n">E</span><span class="o">.</span><span class="n">Description</span><span class="p">(</span><span class="n">description</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">FullName</span><span class="p">(</span><span class="n">full_name</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">EmailAddress</span><span class="p">(</span><span class="n">email</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">Telephone</span><span class="p">(</span><span class="n">telephone</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">IsEnabled</span><span class="p">(</span><span class="n">is_enabled</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">IM</span><span class="p">(</span><span class="n">im</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">IsAlertEnabled</span><span class="p">(</span><span class="n">is_alert_enabled</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">AlertEmailPrefix</span><span class="p">(</span><span class="n">alert_email_prefix</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">AlertEmail</span><span class="p">(</span><span class="n">alert_email</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">IsExternal</span><span class="p">(</span><span class="n">is_external</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">IsDefaultCached</span><span class="p">(</span><span class="n">is_default_cached</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">IsGroupRole</span><span class="p">(</span><span class="n">is_group_role</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">StoredVmQuota</span><span class="p">(</span><span class="n">stored_vm_quota</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">DeployedVmQuota</span><span class="p">(</span><span class="n">deployed_vm_quota</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">Role</span><span class="p">(</span><span class="n">href</span><span class="o">=</span><span class="n">role_href</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">Password</span><span class="p">(</span><span class="n">password</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="n">user_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post_linked_resource</span><span class="p">(</span></div>
            <span class="n">resource_admin</span><span class="p">,</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span> <span class="n">EntityType</span><span class="o">.</span><span class="n">USER</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>

<div class="viewcode-block" id="Org.update_user"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.update_user">[docs]</a>    <span class="k">def</span> <span class="nf">update_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_name</span><span class="p">,</span> <span class="n">is_enabled</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update an User.</span>

<span class="sd">        :param user_name: (str): username of the user</span>
<span class="sd">        :param is_enabled: (bool): enable/disable the user</span>
<span class="sd">        :return: (UserType) Updated user object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">user_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_enabled</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="s1">&#39;IsEnabled&#39;</span><span class="p">):</span>
                <span class="n">user</span><span class="p">[</span><span class="s1">&#39;IsEnabled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">IsEnabled</span><span class="p">(</span><span class="n">is_enabled</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">put_resource</span><span class="p">(</span>
                    <span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">),</span> <span class="n">user</span><span class="p">,</span> <span class="n">EntityType</span><span class="o">.</span><span class="n">USER</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="n">user</span>

<div class="viewcode-block" id="Org.get_user"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.get_user">[docs]</a>    <span class="k">def</span> <span class="nf">get_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve user record from current Organization.</span>

<span class="sd">        :param: (str): user_name: user name of the record to be retrieved</span>

<span class="sd">        :return:  (UserRecord): User record.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">user_record</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_users</span><span class="p">((</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">user_name</span><span class="p">)))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">user_record</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;User </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> does not exist.&#39;</span> <span class="o">%</span> <span class="n">user_name</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="n">user_record</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>

<div class="viewcode-block" id="Org.list_users"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.list_users">[docs]</a>    <span class="k">def</span> <span class="nf">list_users</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_filter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the list of users in the current Org.</span>

<span class="sd">        :param name_filter: (tuple): (name ,&#39;username&#39;) Filter roles by</span>
<span class="sd">            &#39;user name&#39;</span>

<span class="sd">        :return: (list): (UserRecord) List of users.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>
        <span class="n">resource_type</span> <span class="o">=</span> <span class="s1">&#39;user&#39;</span>
        <span class="n">org_filter</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">is_sysadmin</span><span class="p">():</span>
            <span class="n">resource_type</span> <span class="o">=</span> <span class="s1">&#39;adminUser&#39;</span>
            <span class="n">org_filter</span> <span class="o">=</span> <span class="s1">&#39;org==</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_typed_query</span><span class="p">(</span>
            <span class="n">resource_type</span><span class="p">,</span>
            <span class="n">query_result_format</span><span class="o">=</span><span class="n">QueryResultFormat</span><span class="o">.</span><span class="n">RECORDS</span><span class="p">,</span>
            <span class="n">equality_filter</span><span class="o">=</span><span class="n">name_filter</span><span class="p">,</span>
            <span class="n">qfilter</span><span class="o">=</span><span class="n">org_filter</span><span class="p">)</span>
</div>
        <span class="k">return</span> <span class="n">query</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>

<div class="viewcode-block" id="Org.delete_user"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.delete_user">[docs]</a>    <span class="k">def</span> <span class="nf">delete_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete user record from current organization.</span>

<span class="sd">        :param user_name: (str) name of the user that (org/sys)admins wants to</span>
<span class="sd">            delete</span>
<span class="sd">        :return: result of calling DELETE on the user resource</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">user_name</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">delete_resource</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>

<div class="viewcode-block" id="Org.get_role_resource"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.get_role_resource">[docs]</a>    <span class="k">def</span> <span class="nf">get_role_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieves resource of a given role.</span>

<span class="sd">        :param role_name: (str):name of the role</span>

<span class="sd">        :return A :class:`lxml.objectify.StringElement` object representing</span>
<span class="sd">            the role.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">role_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_role_record</span><span class="p">(</span><span class="n">role_name</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="n">role_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>

<div class="viewcode-block" id="Org.get_role_record"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.get_role_record">[docs]</a>    <span class="k">def</span> <span class="nf">get_role_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve role record with a particular name in the current Org.</span>

<span class="sd">        :param role_name: (str): The name of the role object to be retrieved</span>

<span class="sd">        :return: (dict): Role record in dict format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">role_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_roles</span><span class="p">((</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">role_name</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">role_record</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Role </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> does not exist.&#39;</span> <span class="o">%</span> <span class="n">role_name</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="n">role_record</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<div class="viewcode-block" id="Org.list_roles"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.list_roles">[docs]</a>    <span class="k">def</span> <span class="nf">list_roles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_filter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the list of roles in the current Org.</span>

<span class="sd">        :param name_filter: (tuple): (name ,&#39;role name&#39;) Filter roles by</span>
<span class="sd">                             &#39;role name&#39;</span>
<span class="sd">        :return: (list): (RoleRecord) List of roles</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>

        <span class="n">org_filter</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">resource_type</span> <span class="o">=</span> <span class="s1">&#39;role&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">is_sysadmin</span><span class="p">():</span>
            <span class="n">resource_type</span> <span class="o">=</span> <span class="s1">&#39;adminRole&#39;</span>
            <span class="n">org_filter</span> <span class="o">=</span> <span class="s1">&#39;org==</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>

        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_typed_query</span><span class="p">(</span>
            <span class="n">resource_type</span><span class="p">,</span>
            <span class="n">query_result_format</span><span class="o">=</span><span class="n">QueryResultFormat</span><span class="o">.</span><span class="n">RECORDS</span><span class="p">,</span>
            <span class="n">equality_filter</span><span class="o">=</span><span class="n">name_filter</span><span class="p">,</span>
            <span class="n">qfilter</span><span class="o">=</span><span class="n">org_filter</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">execute</span><span class="p">()):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">to_dict</span><span class="p">(</span>
                    <span class="n">r</span><span class="p">,</span> <span class="n">resource_type</span><span class="o">=</span><span class="n">resource_type</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;org&#39;</span><span class="p">,</span>
                                                             <span class="s1">&#39;orgName&#39;</span><span class="p">]))</span></div>
        <span class="k">return</span> <span class="n">result</span>

<div class="viewcode-block" id="Org.add_rights"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.add_rights">[docs]</a>    <span class="k">def</span> <span class="nf">add_rights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rights</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds set of rights to the organization.</span>

<span class="sd">        :param rights: (tuple): tuple of right names</span>

<span class="sd">        :return A :class:`lxml.objectify.StringElement` object representing</span>
<span class="sd">        the updated Org rights</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">org_admin_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href_admin</span><span class="p">)</span>
        <span class="n">org_rights</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">OrgRights</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">right</span> <span class="ow">in</span> <span class="n">rights</span><span class="p">:</span>
            <span class="n">right_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_right_record</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
            <span class="n">org_rights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">E</span><span class="o">.</span><span class="n">RightReference</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">right_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span>
                    <span class="n">href</span><span class="o">=</span><span class="n">right_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">),</span>
                    <span class="nb">type</span><span class="o">=</span><span class="n">EntityType</span><span class="o">.</span><span class="n">RIGHT</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post_linked_resource</span><span class="p">(</span>
            <span class="n">org_admin_resource</span><span class="o">.</span><span class="n">RightReferences</span><span class="p">,</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span></div>
            <span class="n">EntityType</span><span class="o">.</span><span class="n">ORG_RIGHTS</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">org_rights</span><span class="p">)</span>

<div class="viewcode-block" id="Org.remove_rights"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.remove_rights">[docs]</a>    <span class="k">def</span> <span class="nf">remove_rights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rights</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes set of rights from the organization.</span>

<span class="sd">        :param rights: (tuple): tuple of right names</span>

<span class="sd">        :return A :class:`lxml.objectify.StringElement` object representing</span>
<span class="sd">        the updated Org rights</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">org_admin_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href_admin</span><span class="p">)</span>
        <span class="n">org_rights_resource</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">org_admin_resource</span><span class="p">,</span> <span class="s1">&#39;RightReferences&#39;</span><span class="p">):</span>
            <span class="n">org_rights_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span>
                <span class="n">org_admin_resource</span><span class="o">.</span><span class="n">RightReferences</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">org_rights_resource</span><span class="p">,</span> <span class="s1">&#39;RightReference&#39;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">right</span> <span class="ow">in</span> <span class="n">rights</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">right_reference</span> <span class="ow">in</span> \
                            <span class="nb">list</span><span class="p">(</span><span class="n">org_rights_resource</span><span class="o">.</span><span class="n">RightReference</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">right_reference</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">right</span><span class="p">:</span>
                            <span class="n">org_rights_resource</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">right_reference</span><span class="p">)</span>
                            <span class="k">break</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">put_linked_resource</span><span class="p">(</span>
                    <span class="n">org_admin_resource</span><span class="o">.</span><span class="n">RightReferences</span><span class="p">,</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">EDIT</span><span class="p">,</span>
                    <span class="n">EntityType</span><span class="o">.</span><span class="n">ORG_RIGHTS</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">org_rights_resource</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="n">org_rights_resource</span>

<div class="viewcode-block" id="Org.get_right_resource"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.get_right_resource">[docs]</a>    <span class="k">def</span> <span class="nf">get_right_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">right_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieves resource of a given right.</span>

<span class="sd">        :param right_name: (str): name of the right</span>

<span class="sd">        :return A :class:`lxml.objectify.StringElement` object representing</span>
<span class="sd">        the right.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">right_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_right_record</span><span class="p">(</span><span class="n">right_name</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="n">right_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>

<div class="viewcode-block" id="Org.get_right_record"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.get_right_record">[docs]</a>    <span class="k">def</span> <span class="nf">get_right_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">right_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieves corresponding record of the specified right.</span>

<span class="sd">        :param right_name: (str): The name of the right record to be retrieved</span>
<span class="sd">        :return: (dict): Right record in dict format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">right_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_rights_available_in_system</span><span class="p">((</span><span class="s1">&#39;name&#39;</span><span class="p">,</span>
                                                             <span class="n">right_name</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">right_record</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Right </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> does not exist.&#39;</span> <span class="o">%</span> <span class="n">right_name</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="n">right_record</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<div class="viewcode-block" id="Org.list_rights_available_in_system"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.list_rights_available_in_system">[docs]</a>    <span class="k">def</span> <span class="nf">list_rights_available_in_system</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_filter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieves the list of all rights available in the System.</span>

<span class="sd">        :param name_filter: (tuple): (name ,&#39;right name&#39;) Filter the rights by</span>
<span class="sd">                             &#39;right name&#39;</span>
<span class="sd">        :return: (list): (RightRecord) List of rights</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>

        <span class="n">resource_type</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_typed_query</span><span class="p">(</span>
            <span class="n">resource_type</span><span class="p">,</span>
            <span class="n">query_result_format</span><span class="o">=</span><span class="n">QueryResultFormat</span><span class="o">.</span><span class="n">RECORDS</span><span class="p">,</span>
            <span class="n">equality_filter</span><span class="o">=</span><span class="n">name_filter</span><span class="p">)</span>
        <span class="n">records</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">execute</span><span class="p">())</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">to_dict</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">resource_type</span><span class="o">=</span><span class="n">resource_type</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[]))</span></div>
        <span class="k">return</span> <span class="n">result</span>

<div class="viewcode-block" id="Org.list_rights_of_org"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.list_rights_of_org">[docs]</a>    <span class="k">def</span> <span class="nf">list_rights_of_org</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieves the list of rights associated with the Organization.</span>

<span class="sd">        :return: (list): (RightReference) List of rights</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">org_admin_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href_admin</span><span class="p">)</span>
        <span class="n">rights</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">org_admin_resource</span><span class="p">,</span> <span class="s1">&#39;RightReferences&#39;</span><span class="p">)</span> <span class="ow">and</span> \
                <span class="nb">hasattr</span><span class="p">(</span><span class="n">org_admin_resource</span><span class="o">.</span><span class="n">RightReferences</span><span class="p">,</span> <span class="s1">&#39;RightReference&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">rightReference</span> <span class="ow">in</span> \
                    <span class="n">org_admin_resource</span><span class="o">.</span><span class="n">RightReferences</span><span class="o">.</span><span class="n">RightReference</span><span class="p">:</span>
                <span class="n">rights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">to_dict</span><span class="p">(</span><span class="n">rightReference</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]))</span></div>
        <span class="k">return</span> <span class="n">rights</span>

<div class="viewcode-block" id="Org.get_catalog_access_settings"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.get_catalog_access_settings">[docs]</a>    <span class="k">def</span> <span class="nf">get_catalog_access_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catalog_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the access settings of a catalog.</span>

<span class="sd">        :param catalog_name: (str): The name of the catalog.</span>
<span class="sd">        :return:  A :class:`lxml.objectify.StringElement` object representing</span>
<span class="sd">            the access settings of the catalog.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">catalog_name</span><span class="p">)</span>
        <span class="n">acl</span> <span class="o">=</span> <span class="n">Acl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">catalog_resource</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="n">acl</span><span class="o">.</span><span class="n">get_access_settings</span><span class="p">()</span>

<div class="viewcode-block" id="Org.add_catalog_access_settings"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.add_catalog_access_settings">[docs]</a>    <span class="k">def</span> <span class="nf">add_catalog_access_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                    <span class="n">catalog_name</span><span class="p">,</span>
                                    <span class="n">access_settings_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add access settings to a particular catalog.</span>

<span class="sd">        :param catalog_name: (str): name of the catalog for which acl needs</span>
<span class="sd">            to be added.</span>
<span class="sd">        :param access_settings_list: (list of dict): list of access_setting</span>
<span class="sd">            in the dict format. Each dict contains:</span>
<span class="sd">            type: (str): type of the subject. One of &#39;org&#39; or &#39;user&#39;.</span>
<span class="sd">            name: (str): name of the user or org.</span>
<span class="sd">            access_level: (str): access_level of the particular subject. One of</span>
<span class="sd">            &#39;ReadOnly&#39;, &#39;Change&#39;, &#39;FullControl&#39;</span>

<span class="sd">        :return:  A :class:`lxml.objectify.StringElement` object representing</span>
<span class="sd">            the updated access control setting of the catalog.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">catalog_name</span><span class="p">)</span>
        <span class="n">acl</span> <span class="o">=</span> <span class="n">Acl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">catalog_resource</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="n">acl</span><span class="o">.</span><span class="n">add_access_settings</span><span class="p">(</span><span class="n">access_settings_list</span><span class="p">)</span>

<div class="viewcode-block" id="Org.remove_catalog_access_settings"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.remove_catalog_access_settings">[docs]</a>    <span class="k">def</span> <span class="nf">remove_catalog_access_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                       <span class="n">catalog_name</span><span class="p">,</span>
                                       <span class="n">access_settings_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                       <span class="n">remove_all</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove access settings from a particular catalog.</span>

<span class="sd">        :param catalog_name: (name): catalog name from which access_settings</span>
<span class="sd">            should be removed.</span>
<span class="sd">        :param access_settings_list: (list of dict): list of access_setting</span>
<span class="sd">            in the dict format. Each dict contains:</span>
<span class="sd">            type: (str): type of the subject. One of &#39;org&#39; or &#39;user&#39;.</span>
<span class="sd">            name: (str): name of the user or org.</span>
<span class="sd">        :param remove_all: (bool) : True if all access settings of the catalog</span>
<span class="sd">            should be removed</span>

<span class="sd">        :return:  A :class:`lxml.objectify.StringElement` object representing</span>
<span class="sd">            the updated access control setting of the catalog.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">catalog_name</span><span class="p">)</span>
        <span class="n">acl</span> <span class="o">=</span> <span class="n">Acl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">catalog_resource</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="n">acl</span><span class="o">.</span><span class="n">remove_access_settings</span><span class="p">(</span><span class="n">access_settings_list</span><span class="p">,</span> <span class="n">remove_all</span><span class="p">)</span>

<div class="viewcode-block" id="Org.share_catalog_with_org_members"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.share_catalog_with_org_members">[docs]</a>    <span class="k">def</span> <span class="nf">share_catalog_with_org_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                       <span class="n">catalog_name</span><span class="p">,</span>
                                       <span class="n">everyone_access_level</span><span class="o">=</span><span class="s1">&#39;ReadOnly&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Share the catalog to all members of the organization.</span>

<span class="sd">        :param catalog_name: (str): catalog name whose access should be</span>
<span class="sd">            shared to everyone.</span>
<span class="sd">        :param everyone_access_level: (str) : access level when sharing the</span>
<span class="sd">            catalog with everyone. One of &#39;ReadOnly&#39;, &#39;Change&#39;, &#39;FullControl&#39;</span>
<span class="sd">            &#39;ReadOnly&#39; by default.</span>

<span class="sd">        :return:  A :class:`lxml.objectify.StringElement` object representing</span>
<span class="sd">            the updated access control setting of the catalog.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">catalog_name</span><span class="p">)</span>
        <span class="n">acl</span> <span class="o">=</span> <span class="n">Acl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">catalog_resource</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="n">acl</span><span class="o">.</span><span class="n">share_with_org_members</span><span class="p">(</span><span class="n">everyone_access_level</span><span class="p">)</span>

<div class="viewcode-block" id="Org.unshare_catalog_with_org_members"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.unshare_catalog_with_org_members">[docs]</a>    <span class="k">def</span> <span class="nf">unshare_catalog_with_org_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catalog_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Unshare the catalog from all members of current organization.</span>

<span class="sd">        :param catalog_name: (str): catalog name whose access should be</span>
<span class="sd">            unshared from everyone.</span>

<span class="sd">        :return:  A :class:`lxml.objectify.StringElement` object representing</span>
<span class="sd">            the updated access control setting of the catalog.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">catalog_name</span><span class="p">)</span>
        <span class="n">acl</span> <span class="o">=</span> <span class="n">Acl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">catalog_resource</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="n">acl</span><span class="o">.</span><span class="n">unshare_from_org_members</span><span class="p">()</span>

<div class="viewcode-block" id="Org.change_catalog_owner"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.change_catalog_owner">[docs]</a>    <span class="k">def</span> <span class="nf">change_catalog_owner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catalog_name</span><span class="p">,</span> <span class="n">user_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Change the ownership of Catalog to a given user.</span>

<span class="sd">        :param catalog_name: Catalog whose ownership needs to be changed</span>
<span class="sd">        :param user_name: New Owner of the Catalog</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>
        <span class="n">catalog_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_catalog_resource</span><span class="p">(</span>
            <span class="n">catalog_name</span><span class="p">,</span> <span class="n">is_admin_operation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">owner_link</span> <span class="o">=</span> <span class="n">find_link</span><span class="p">(</span>
            <span class="n">catalog_resource</span><span class="p">,</span>
            <span class="n">rel</span><span class="o">=</span><span class="n">RelationType</span><span class="o">.</span><span class="n">DOWN</span><span class="p">,</span>
            <span class="n">media_type</span><span class="o">=</span><span class="n">EntityType</span><span class="o">.</span><span class="n">OWNER</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="n">fail_if_absent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">catalog_href</span> <span class="o">=</span> <span class="n">owner_link</span><span class="o">.</span><span class="n">href</span>

        <span class="n">user_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_user</span><span class="p">(</span><span class="n">user_name</span><span class="p">)</span>
        <span class="n">new_owner</span> <span class="o">=</span> <span class="n">catalog_resource</span><span class="o">.</span><span class="n">Owner</span>
        <span class="n">new_owner</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">,</span> <span class="n">user_resource</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>
        <span class="n">objectify</span><span class="o">.</span><span class="n">deannotate</span><span class="p">(</span><span class="n">new_owner</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">put_resource</span><span class="p">(</span><span class="n">catalog_href</span><span class="p">,</span> <span class="n">new_owner</span><span class="p">,</span></div>
                                        <span class="n">EntityType</span><span class="o">.</span><span class="n">OWNER</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="Org.update_org"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.update_org">[docs]</a>    <span class="k">def</span> <span class="nf">update_org</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_enabled</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update an organization.</span>

<span class="sd">        :param is_enabled: (bool): enable/disable the organization</span>
<span class="sd">        :return: (AdminOrgType) updated org object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">org_admin_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href_admin</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_enabled</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">org_admin_resource</span><span class="p">,</span> <span class="s1">&#39;IsEnabled&#39;</span><span class="p">):</span>
                <span class="n">org_admin_resource</span><span class="p">[</span><span class="s1">&#39;IsEnabled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">IsEnabled</span><span class="p">(</span><span class="n">is_enabled</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">put_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href_admin</span><span class="p">,</span>
                                                <span class="n">org_admin_resource</span><span class="p">,</span>
                                                <span class="n">EntityType</span><span class="o">.</span><span class="n">ADMIN_ORG</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>
        <span class="k">return</span> <span class="n">org_admin_resource</span>

<div class="viewcode-block" id="Org.create_org_vdc"><a class="viewcode-back" href="../../../pyvcloud.vcd.html#pyvcloud.vcd.org.Org.create_org_vdc">[docs]</a>    <span class="k">def</span> <span class="nf">create_org_vdc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">vdc_name</span><span class="p">,</span>
                       <span class="n">provider_vdc_name</span><span class="p">,</span>
                       <span class="n">description</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                       <span class="n">allocation_model</span><span class="o">=</span><span class="s1">&#39;AllocationVApp&#39;</span><span class="p">,</span>
                       <span class="n">cpu_units</span><span class="o">=</span><span class="s1">&#39;MHz&#39;</span><span class="p">,</span>
                       <span class="n">cpu_allocated</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">cpu_limit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">mem_units</span><span class="o">=</span><span class="s1">&#39;MB&#39;</span><span class="p">,</span>
                       <span class="n">mem_allocated</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">mem_limit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">nic_quota</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">network_quota</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">vm_quota</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">storage_profiles</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">resource_guaranteed_memory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">resource_guaranteed_cpu</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">vcpu_in_mhz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">is_thin_provision</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">network_pool_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">uses_fast_provisioning</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">over_commit_allowed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">vm_discovery_enabled</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">is_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create Organization VDC in the current Org.</span>

<span class="sd">        :param vdc_name (str): The name of the new org vdc.</span>
<span class="sd">        :param provider_vdc_name (str): The name of an existing provider vdc.</span>
<span class="sd">        :param description (str): The description of the new org vdc.</span>
<span class="sd">        :param allocation_model (str): The allocation model used by this vDC.</span>
<span class="sd">            One of AllocationVApp, AllocationPool or ReservationPool.</span>
<span class="sd">        :param cpu_units (str): The cpu units compute capacity allocated to</span>
<span class="sd">            this vDC. One of MHz or GHz</span>
<span class="sd">        :param cpu_allocated (int): Capacity that is committed to be available.</span>
<span class="sd">        :param cpu_limit (int): Capacity limit relative to the value specified</span>
<span class="sd">            for Allocation.</span>
<span class="sd">        :param mem_units (str): The memory units compute capacity allocated to</span>
<span class="sd">            this vDC. One of MB or GB.</span>
<span class="sd">        :param mem_allocated (int): Memory capacity that is committed to be</span>
<span class="sd">            available.</span>
<span class="sd">        :param mem_limit (int): Memory capacity limit relative to the value</span>
<span class="sd">            specified for Allocation.</span>
<span class="sd">        :param nic_quota (int): Maximum number of virtual NICs allowed in this</span>
<span class="sd">            vDC. Defaults to 0, which specifies an unlimited number.</span>
<span class="sd">        :param network_quota (int): Maximum number of network objects that can</span>
<span class="sd">            be deployed in this vDC. Defaults to 0, which means no networks can</span>
<span class="sd">            be deployed.</span>
<span class="sd">        :param vm_quota (int): The maximum number of VMs that can be created in</span>
<span class="sd">            this vDC. Defaults to 0, which specifies an unlimited number.</span>
<span class="sd">        :param storage_profiles: List of provider vDC storage profiles to add</span>
<span class="sd">            to this vDC.</span>
<span class="sd">            Each item is a dictionary that should include the following</span>
<span class="sd">                elements:</span>
<span class="sd">                name: (string) name of the PVDC storage profile.</span>
<span class="sd">                enabled: (bool) True if the storage profile is enabled for this</span>
<span class="sd">                    vDC.</span>
<span class="sd">                units: (string) Units used to define limit. One of MB or GB.</span>
<span class="sd">                limit: (int) Max number of units allocated for this storage</span>
<span class="sd">                    profile.</span>
<span class="sd">                default: (bool) True if this is default storage profile for</span>
<span class="sd">                    this vDC.</span>
<span class="sd">        :param resource_guaranteed_memory (float): Percentage of allocated CPU</span>
<span class="sd">            resources guaranteed to vApps deployed in this vDC.</span>
<span class="sd">            Value defaults to 1.0 if the element is empty.</span>
<span class="sd">        :param resource_guaranteed_cpu (float): Percentage of allocated memory</span>
<span class="sd">            resources guaranteed to vApps deployed in this vDC.</span>
<span class="sd">            Value defaults to 1.0 if the element is empty.</span>
<span class="sd">        :param vcpu_in_mhz (int): Specifies the clock frequency, in Megahertz,</span>
<span class="sd">            for any virtual CPU that is allocated to a VM.</span>
<span class="sd">        :param is_thin_provision (bool): Boolean to request thin provisioning.</span>
<span class="sd">        :param network_pool_name (str): Reference to a network pool in the</span>
<span class="sd">            Provider vDC.</span>
<span class="sd">        :param uses_fast_provisioning (bool): Boolean to request fast</span>
<span class="sd">            provisioning.</span>
<span class="sd">        :param over_commit_allowed (bool): Set to false to disallow creation of</span>
<span class="sd">            the VDC if the AllocationModel is AllocationPool or ReservationPool</span>
<span class="sd">            and the ComputeCapacity you specified is greater than what the</span>
<span class="sd">            backing Provider VDC can supply. Defaults to true if empty or</span>
<span class="sd">            missing.</span>
<span class="sd">        :param vm_discovery_enabled (bool): True if discovery of vCenter VMs</span>
<span class="sd">            is enabled for resource pools backing this vDC.</span>
<span class="sd">        :param is_enabled (bool): True if this vDC is enabled for use by the</span>
<span class="sd">            organization users.</span>
<span class="sd">        :return:  A :class:`lxml.objectify.StringElement` object describing</span>
<span class="sd">            the new VDC.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href</span><span class="p">)</span>
        <span class="n">sys_admin_resource</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_admin</span><span class="p">()</span>
        <span class="n">system</span> <span class="o">=</span> <span class="n">System</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">admin_resource</span><span class="o">=</span><span class="n">sys_admin_resource</span><span class="p">)</span>
        <span class="n">pvdc</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_provider_vdc</span><span class="p">(</span><span class="n">provider_vdc_name</span><span class="p">)</span>
        <span class="n">resource_admin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">href_admin</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">CreateVdcParams</span><span class="p">(</span>
            <span class="n">E</span><span class="o">.</span><span class="n">Description</span><span class="p">(</span><span class="n">description</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">AllocationModel</span><span class="p">(</span><span class="n">allocation_model</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">ComputeCapacity</span><span class="p">(</span>
                <span class="n">E</span><span class="o">.</span><span class="n">Cpu</span><span class="p">(</span>
                    <span class="n">E</span><span class="o">.</span><span class="n">Units</span><span class="p">(</span><span class="n">cpu_units</span><span class="p">),</span> <span class="n">E</span><span class="o">.</span><span class="n">Allocated</span><span class="p">(</span><span class="n">cpu_allocated</span><span class="p">),</span>
                    <span class="n">E</span><span class="o">.</span><span class="n">Limit</span><span class="p">(</span><span class="n">cpu_limit</span><span class="p">)),</span>
                <span class="n">E</span><span class="o">.</span><span class="n">Memory</span><span class="p">(</span>
                    <span class="n">E</span><span class="o">.</span><span class="n">Units</span><span class="p">(</span><span class="n">mem_units</span><span class="p">),</span> <span class="n">E</span><span class="o">.</span><span class="n">Allocated</span><span class="p">(</span><span class="n">mem_allocated</span><span class="p">),</span>
                    <span class="n">E</span><span class="o">.</span><span class="n">Limit</span><span class="p">(</span><span class="n">mem_limit</span><span class="p">))),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">NicQuota</span><span class="p">(</span><span class="n">nic_quota</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">NetworkQuota</span><span class="p">(</span><span class="n">network_quota</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">VmQuota</span><span class="p">(</span><span class="n">vm_quota</span><span class="p">),</span>
            <span class="n">E</span><span class="o">.</span><span class="n">IsEnabled</span><span class="p">(</span><span class="n">is_enabled</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="n">vdc_name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">storage_profiles</span><span class="p">:</span>
            <span class="n">pvdc_sp</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_provider_vdc_storage_profile</span><span class="p">(</span><span class="n">sp</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">E</span><span class="o">.</span><span class="n">VdcStorageProfile</span><span class="p">(</span>
                    <span class="n">E</span><span class="o">.</span><span class="n">Enabled</span><span class="p">(</span><span class="n">sp</span><span class="p">[</span><span class="s1">&#39;enabled&#39;</span><span class="p">]),</span>
                    <span class="n">E</span><span class="o">.</span><span class="n">Units</span><span class="p">(</span><span class="n">sp</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]),</span>
                    <span class="n">E</span><span class="o">.</span><span class="n">Limit</span><span class="p">(</span><span class="n">sp</span><span class="p">[</span><span class="s1">&#39;limit&#39;</span><span class="p">]),</span>
                    <span class="n">E</span><span class="o">.</span><span class="n">Default</span><span class="p">(</span><span class="n">sp</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]),</span>
                    <span class="n">E</span><span class="o">.</span><span class="n">ProviderVdcStorageProfile</span><span class="p">(</span><span class="n">href</span><span class="o">=</span><span class="n">pvdc_sp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))))</span>
        <span class="k">if</span> <span class="n">resource_guaranteed_memory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">E</span><span class="o">.</span><span class="n">ResourceGuaranteedMemory</span><span class="p">(</span><span class="n">resource_guaranteed_memory</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">resource_guaranteed_cpu</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">ResourceGuaranteedCpu</span><span class="p">(</span><span class="n">resource_guaranteed_cpu</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">vcpu_in_mhz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">VCpuInMhz</span><span class="p">(</span><span class="n">vcpu_in_mhz</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">is_thin_provision</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">IsThinProvision</span><span class="p">(</span><span class="n">is_thin_provision</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">network_pool_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">npr</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_network_pool_reference</span><span class="p">(</span><span class="n">network_pool_name</span><span class="p">)</span>
            <span class="n">href</span> <span class="o">=</span> <span class="n">npr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>
            <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">E</span><span class="o">.</span><span class="n">NetworkPoolReference</span><span class="p">(</span>
                    <span class="n">href</span><span class="o">=</span><span class="n">href</span><span class="p">,</span>
                    <span class="nb">id</span><span class="o">=</span><span class="n">href</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="nb">type</span><span class="o">=</span><span class="n">npr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">npr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)))</span>
        <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pvdc</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">uses_fast_provisioning</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">UsesFastProvisioning</span><span class="p">(</span><span class="n">uses_fast_provisioning</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">over_commit_allowed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">OverCommitAllowed</span><span class="p">(</span><span class="n">over_commit_allowed</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">vm_discovery_enabled</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">VmDiscoveryEnabled</span><span class="p">(</span><span class="n">vm_discovery_enabled</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post_linked_resource</span><span class="p">(</span>
            <span class="n">resource_admin</span><span class="p">,</span> <span class="n">RelationType</span><span class="o">.</span><span class="n">ADD</span><span class="p">,</span> <span class="n">EntityType</span><span class="o">.</span><span class="n">VDCS_PARAMS</span><span class="o">.</span><span class="n">value</span><span class="p">,</span></div></div>
            <span class="n">params</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, VMware.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>